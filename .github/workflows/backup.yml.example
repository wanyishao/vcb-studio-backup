name: VCB-Studio Backup

# 1. 触发条件：使用 cron 表达式定义定时运行时间
#    这个例子设置为：每天 UTC 时间 02:00 运行
#    (cron 语法: 分 时 日 月 周)
on:
  schedule:
    - cron: '0 17 * * *' 
  # 也可以添加 workflow_dispatch 让您可以手动触发运行
  workflow_dispatch:

jobs:
  run_backup:
    # 2. 运行环境
    runs-on: ubuntu-latest

    steps:
      # 3. 检出代码
      - name: Checkout repository
        uses: actions/checkout@v4

      # 4. 设置 Python 环境
      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.x'

      # 5. 安装依赖
      - name: Install dependencies
        run: |
          pip install requests beautifulsoup4

      # 6. 运行脚本
      - name: Run Python Backup Script
        run: python vcb-s.py 

      # 7. (可选但推荐) 提交下载的变更
      #    由于下载会创建或更新 page/ 和 archives/ 文件夹，您需要提交这些变更以保存备份。
      - name: Commit and Push changes
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          commit_message: Automated VCB-Studio Backup Update
          # 如果文件非常多，可以考虑只提交重要的文件或限制提交大小
          # file_pattern: page/*.html archives/*.html
